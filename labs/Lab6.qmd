---
title: "Lab 6"
format: gfm
editor: visual
---

```{r message=FALSE, warning=FALSE}
# Load required packages
library(tidyverse)
library(knitr)

# Read in the data
whales <- read_csv("https://raw.githubusercontent.com/nt246/NTRES-6100-data-science/main/datasets/whales.csv")
whales |> head() |> kable()
```

**Question 1. Create a new data frame that has one row per observer, per species and one single variable of all the information collected. Name this data frame `whales_long`.**

```{r}
whales_long <- whales |> 
pivot_longer(c("blue","humpback","southern_right", "sei","fin",
               "killer_whale","bowhead","grey"),names_to = "species") 

whales_long |> 
head() |> 
kable()
```

**Question 2. Starting from `whales_long`, create another data frame that includes only events for which there is information. Name this data frame `whales_clean`.**

```{r}
whales_clean <- whales_long |> drop_na() 

whales_clean |> 
  head() |> 
  kable()
```

**Question 3. Starting from `whales_clean`, create another data frame with one variable per type of information, one piece of information per cell. Some cells might be empty. Name this data frame `whales_split`.**

```{r}
whales_split <- whales_clean |> 
separate(value,into=c("date","outcome","size","ocean"),sep = ",") 

whales_split |> 
  head() |> 
  kable()
```

**Question 4. Starting from `whales_split`, create another data frame in which all columns are parsed as instructed below. Name this data frame `whales_parsed`.**

The columns should parsed to the following types
* observer: double
* species: character
* date: date
* outcome: character
* size: integer
* ocean: character

```{r}
whales_parsed <- whales_split |> 
mutate(date=parse_date(date, "%m/%d/%y")) |> 
mutate(size=parse_integer(size)) 

whales_parsed |> 
head()|> 
kable()
```

**Question 5. Using whales_parsed, print a summary table with: 1) number ship strikes by species, 2) average whale size by species, omitting NA values in the calculation.**

```{r}
whales_parsed |> 
group_by(species) |> 
summarize(strikes_per_species=n()) |> 
kable()
```

```{r}
whales_parsed |> 
drop_na() |> 
group_by(species) |> 
summarize(average_size=mean(size)) |> 
kable()
```

**Question 6. Try to summarize as much information contained in `whales_parsed` as possible in one plot.**

```{r}
whales_parsed |> 
select(-observer) |> 
group_by(species) |> 
ggplot()+
geom_histogram(mapping=aes(x=size,color=species)) + 
labs (title = "Size and Number of obs. by Species")
```

I was unable to use ocean as a facet wrap like I wanted to because the way
the ocean names are spelled is inconsistent. I also couldn't use years as a 
facet because the data is recorded in individual days.
