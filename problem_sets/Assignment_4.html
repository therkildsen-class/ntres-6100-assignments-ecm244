<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assignment 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment_4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment_4_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment_4_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment_4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment_4_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment_4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment_4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment_4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment_4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment_4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<p>To start, load all the required packages with the following code. Install them if they are not installed yet.</p>
</section>
<section id="exercise-1.-corruption-and-human-development" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1.-corruption-and-human-development">Exercise 1. Corruption and human development</h2>
<p>This exercise explores a dataset containing the human development index <code>(HDI)</code> and corruption perception index <code>(CPI)</code> of 173 countries across 6 different regions around the world: Americas, Asia Pacific, Eastern Europe and Central Asia <code>(East EU Cemt)</code>, Western Europe <code>(EU W. Europe)</code>, Middle East and North Africa and Noth Africa <code>(MENA)</code>, and Sub-Saharan Africa <code>(SSA)</code>. (Note: the larger <code>CPI</code> is, the less corrupted the country is perceived to be.)</p>
<p><br></p>
<p>First, we load the data using the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>economist_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/nt246/NTRES-6100-data-science/master/datasets/EconomistData.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p><strong>1.1 Show the first few rows of <code>economist_data.</code></strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  X     Country HDI.Rank   HDI CPI            Region
1 1 Afghanistan      172 0.398 1.5      Asia Pacific
2 2     Albania       70 0.739 3.1 East EU Cemt Asia
3 3     Algeria       96 0.698 2.9              MENA
4 4      Angola      148 0.486 2.0               SSA
5 5   Argentina       45 0.797 3.0          Americas
6 6     Armenia       86 0.716 2.6 East EU Cemt Asia</code></pre>
</div>
</div>
<p><br></p>
<p><strong>1.2 Expore the relationship between human development index <code>(HDI)</code> and corruption perception index <code>(CPI)</code> with a scatter plot as the following.</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.3 Make the color of all points in the previous plot red.</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.4 Color the points in the previous plot according to the <code>Region</code> variable, and set the size of points to 2.</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.5 Set the size of the points proportional to <code>HDI.Rank</code></strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.6 Fit a smoothing line to all the data points in the scatter plot from Excercise 1.4</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.7 Fit a separate straight line for each region instead, and turn off the confidence interval.</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.8 Building on top of the previous plot, show each <code>Region</code> in a different facet.</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.9 Show the distribution of <code>HDI</code> in each region using density plot. Set the transparency to 0.5</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.10 Show the distribution of <code>HDI</code> in each region using histogram and facetting.</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.11 Show the distribution of <code>HDI</code> in each region using a box plot. Set the transparency of these boxes to 0.5 and do not show outlier points with the box plot. Instead, show all data points for each country in the same plot. (Hint: geom_jitter() or position_jitter() might be useful.)</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.12 Show the count of countries in each region using a bar plot.</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_bar(mapping = aes(x = Region, Fill = Region)): Ignoring unknown
aesthetics: Fill</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment_4_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<p><strong>1.13 You have now created a variety of different plots of the same dataset. Which of your plots do you think are the most informative? Describe briefly the major trends that you see in the data.</strong></p>
<p>Answer:</p>
<p>In general CPI increases as HDI increases and in my opinion the graph that showed that best was the graph from 1.6.</p>
</section>
<section id="exercise-2.-theophylline-experiment" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.-theophylline-experiment">Exercise 2. Theophylline experiment</h2>
<p>This exercise uses the <code>Theoph</code> data frame (comes with your R installation), which has 132 rows and 5 columns of data from an experiment on the pharmacokinetics of the anti-asthmatic drug theophylline. Twelve subjects were given oral doses of theophylline then serum concentrations were measured at 11 time points over the next 25 hours. You can learn more about this dataset by running <code>?Theoph</code></p>
<p>Have a look at the data structure</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Wt</th>
<th style="text-align: right;">Dose</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">conc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">2.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">6.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">10.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">9.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">8.58</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For the following exercise, <strong>transform the data as instructed.</strong> Try to use tidyverse functions even if you are more comfortable with base-R solutions. Show the <strong>first 6 lines</strong> of the transformed data in a table through RMarkdown using the <strong>kable() function</strong>, as shown above.</p>
<p><br></p>
<p><strong>2.1 Select columns that contain a lower case “t” in the <code>Theoph</code> dataset. Do not manually list all the columns to include.</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Wt</th>
<th style="text-align: right;">Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">1.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">2.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">3.82</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>2.2 Rename the <code>Wt</code> column to <code>Weight</code> and <code>conc</code> column to <code>Concentration</code> in the <code>Theoph</code> dataset.</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Weight</th>
<th style="text-align: right;">Dose</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Concentrtation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">2.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">6.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">10.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">9.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">8.58</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>2.3 Extract the <code>Dose</code> greater than 4.5 and <code>Time</code> greater than the mean <code>Time.</code></strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Wt</th>
<th style="text-align: right;">Dose</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">conc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">70.5</td>
<td style="text-align: right;">4.53</td>
<td style="text-align: right;">7.07</td>
<td style="text-align: right;">5.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">70.5</td>
<td style="text-align: right;">4.53</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: right;">4.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">70.5</td>
<td style="text-align: right;">4.53</td>
<td style="text-align: right;">12.15</td>
<td style="text-align: right;">3.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">70.5</td>
<td style="text-align: right;">4.53</td>
<td style="text-align: right;">24.17</td>
<td style="text-align: right;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">7.02</td>
<td style="text-align: right;">7.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">9.10</td>
<td style="text-align: right;">5.90</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>2.4 Sort the Theoph dataset by <code>Wt</code> from smallest to largest and secondarily by <code>Time</code> from largest to smallest.</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Wt</th>
<th style="text-align: right;">Dose</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">conc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">2.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">5.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">11.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">9.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">54.6</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">8.74</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>2.5 Create a new column called <code>Quantity</code> that equals to `Wt x Dose in the Theoph dataset. This will tell you the absolute quantity of drug administered to the subject (in mg). Replace the Dose variable with Quantity.</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">Wt</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">conc</th>
<th style="text-align: right;">Quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">319.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">319.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">6.57</td>
<td style="text-align: right;">319.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">10.50</td>
<td style="text-align: right;">319.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">9.66</td>
<td style="text-align: right;">319.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">79.6</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">8.58</td>
<td style="text-align: right;">319.99</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>2.6 Find the mean <code>conc</code> and sum of the <code>Dose</code> received by each test subject.</strong></p>
<p>Show data for the 6 subjects with the smallest sum of <code>Dose</code> as below. <strong>Do not define new intermediate objects for this exercise; use pipes to chain together functions</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Subject</th>
<th style="text-align: right;">mean_conc</th>
<th style="text-align: right;">total_dose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">3.525454</td>
<td style="text-align: right;">44.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">3.910909</td>
<td style="text-align: right;">54.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">4.271818</td>
<td style="text-align: right;">49.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">4.510909</td>
<td style="text-align: right;">54.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">5.086364</td>
<td style="text-align: right;">49.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">4.823636</td>
<td style="text-align: right;">48.40</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>